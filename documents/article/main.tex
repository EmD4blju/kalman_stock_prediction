\documentclass[12pt]{article}

%~ Packages
\usepackage{amsmath}   % For math
\usepackage{graphicx}  % For images
\usepackage{float}     % For stronger figure placement
\usepackage{hyperref}  % For links
\usepackage[T1]{fontenc}
\usepackage{geometry} % For margins
\usepackage[utf8]{inputenc} % Polish characters
\usepackage[polish]{babel} % Polish language support
\usepackage{times} % Use Times font
\usepackage{indentfirst} % Indent first paragraph after section
\usepackage{titlesec} % Customize section titles

%~ Document settings
\geometry{a4paper, margin=2.5cm}
% \renewcommand{\familydefault}{\sfdefault} % Switched to Times

% Adjust justification to prevent overfull boxes without hyphenation
\tolerance=1000
\emergencystretch=\maxdimen
\hyphenpenalty=10000
\hbadness=10000

%~ Section formatting
\titleformat{\section}{\Large\bfseries}{\thesection.}{1em}{}
\titleformat{\subsection}{\large\bfseries}{\thesubsection.}{1em}{}


%~ Document
\begin{document}

%~ Main Page
\begin{titlepage}
    \centering
    
    \includegraphics[width=0.4\textwidth]{/home/emdablju/Documents/projects/kalman_stock_prediction/documents/article/assets/PJATK_PL_sygnet.png}

    {\Large Polsko-Japońska Akademia Technik Komputerowych}
    
    \vspace{0.5cm}
    
    {\large Wydział Informatyki}
    
    \vspace{2cm}
    
    {\huge\bfseries Zastosowanie filtrów Kalmana do poprawy predykcji cen giełdowych przy użyciu sieci LSTM}
    
    \vspace{2cm}
    
    {\Large Praca Dyplomowa}
    
    \vspace{2cm}
    
    \begin{flushleft}
    \begin{tabular}{ll}
        \textbf{Autor:} & Mikołaj Warda (s28034) \\
        \textbf{Kierunek studiów:} & Informatyka \\
        \textbf{Specjalizacja:} & Data Science \\
        \textbf{Promotor:} & dr Sinh Hoa Nguyen Thi \\
    \end{tabular}
    \end{flushleft}
    
    \vfill
    
    {\large \today}
    
\end{titlepage}

%~ Table of Contents
\tableofcontents
\clearpage

%~ Abstract
\begin{abstract}
    
\end{abstract}
\clearpage

%~ Introduction
\section{Wstęp}

Prognozowanie cen akcji odgrywa kluczową rolę w finansach, wspierając inwestorów w podejmowaniu świadomych decyzji zarządzania swoim portfolio.
Chaotyczny charakter rynków sprawia jednak, że trafne przewidywanie notowań pozostaje trudnym zadaniem.
Tradycyjna analiza techniczna bywa niewystarczająca - jest wrażliwa na szum, a wnioski często zawierają element subiektywności.

W ostatnich latach dynamiczny rozwój uczenia maszynowego, zwłaszcza sieci neuronowych, 
znacząco zmienił podejście do modelowania danych czasowych (w tym giełdowych).
Architektury takie jak LSTM (Long Short-Term Memory) potrafią uchwycić złożone zależności i długookresowe relacje w danych, 
co czyni je obiecującymi narzędziami do prognozowania cen, jednak ich skuteczność nadal zależy od jakości danych wejściowych.
Głównym problemem, jak w przypadku podejść tradycyjnych, jest wysoka wrażliwość na losowe wahania, 
które są nieodłącznym elementem danych finansowych. Te zniekształcenia wynikają z nieprzewidywalnych zdarzeń rynkowych.
Model, zamiast uczyć się rzeczywistych trendów, modeluje wspomniane zakłócenia, 
obniżając swoją zdolność do generalizacji na nowych danych. 
W rezultacie, predykcje mogą być obarczone znacznym błędem, 
co podważa ich użyteczność w podejmowaniu decyzji inwestycyjnych.

Można temu zapobiegać stosując techniki filtracji na danych wejściowych.
Jednym z klasycznych narzędzi tego typu jest filtr Kalmana,
który może pełnić rolę modułu wygładzania i korekty obserwacji, podnosząc stabilność i dokładność predykcji.
Trenowanie sieci neuronowej na przefiltrowanych danych przy użyciu filtra Kalmana może zredukować wpływ szumu, 
pozwalając na lepsze uchwycenie istotnych wzorców i trendów w danych.

W ramach niniejszej pracy dyplomowej, podjęto się zbadania skuteczności zastosowania filtra Kalmana jako etapu przetwarzania danych dla modeli LSTM w kontekście prognozowania cen akcji spółki Amazon.com Inc (AMZN) .
Wybór tematu pracy wyniknął z chęci zdobycia wiedzy na temat działania architektury LSTM oraz zbadania wpływu filtracji danych na jakość prognoz.
Dodatkową motywacją była możliwość wszechstronnego rozwoju ze względu na złożony charakter problemu, łączącego zagadnienia z dziedziny uczenia maszynowego, analizy szeregów czasowych oraz teorii filtrów.

W dalszej części pracy, w sekcji \textit{"Podstawy teoretyczne"}, przedstawiono wszelkie niezbędne pojęcia związane z tematem pracy i przebiegiem badań ze szczególnym naciskiem na architekturę sieci LSTM oraz filtr Kalmana.
Następnie, w sekcji \textit{"Metodyka badań"}, opisano podejście badawcze, w tym przygotowanie danych, implementację modelu, metryki oceny oraz wykorzystane narzędzia.
Kolejna sekcja \textit{"Wyniki i dyskusja"} prezentuje uzyskane wyniki eksperymentów wraz z ich analizą i interpretacją.
Na zakończenie, w sekcji \textit{"Podsumowanie i wnioski"}, podsumowano przeprowadzone badania, przedstawiono kluczowe wnioski oraz zasugerowano kierunki dalszych badań w tym obszarze.

%~ Fundamentals
\clearpage
\section{Podstawy teoretyczne}
\subsection{Przewidywanie szeregów czasowych na rynkach finansowych}
Dane finansowe, takie jak np. ceny akcji, zawierają obserwacje tworzące szeregi czasowe.
Innymi słowy, są to dane, które reprezentują zmiany wartości w określonych odstępach czasu.
Formalnie szeregiem czasowym określa się zbiór uporządkowanych obserwacji w czasie, gdzie każda obserwacja jest powiązana z określoną chwilą czasową:
\begin{equation}
    X = \{x_1, x_2, x_3, \ldots, x_n\}
\end{equation}
gdzie \( x_i \) reprezentuje wartość obserwacji w czasie \( t_i \), a \( n \) to liczba obserwacji w szeregu czasowym.

Abstrahując od rynków finansowych, przedstawię kilka przykładów szeregów czasowych z innych dziedzin, celem lepszego zobrazowania tej koncepcji:
\begin{itemize}
    \item \textbf{Energetyka:} Godzinowe zużycie energii elektrycznej
    \item \textbf{Meteorologia:} Codzienny pomiar temperatury
    \item \textbf{Sport:} Wyniki meczów drużyny na przestrzeni sezonu
\end{itemize}

Najczęściej spotykanym formatem danych finansowych są tzw. dane OHLC.
Przedstawione w takiej postaci informacje tworzą szereg czasowy, w którym każda obserwacja składa się z czterech części:
\begin{itemize}
    \item \textbf{Open (O):} Cena otwarcia - cena, po której dany instrument finansowy rozpoczął notowania w danym okresie.
    \item \textbf{High (H):} Cena najwyższa - najwyższa cena osiągnięta przez instrument finansowy w danym okresie.
    \item \textbf{Low (L):} Cena najniższa - najniższa cena osiągnięta przez instrument finansowy w danym okresie.
    \item \textbf{Close (C):} Cena zamknięcia - cena, po której instrument finansowy zakończył notowania w danym okresie.
\end{itemize}
Na potrzeby tej pracy, wykorzystano składnik \textit{Close}, ze względu na jego powszechne wykorzystanie w analizie i prognozie cen akcji.

Rysunek 1 przedstawia przykładowy wykres cenowy względem składnika \textit{Close} spółki Amazon.com Inc (AMZN) na przestrzeni kilku lat w odstępach dziennych. 
Dane przedstawione na wykresie są nieregularne i zawierają liczne fluktuacje, co jest charakterystyczne dla danych finansowych.
Ta wysoka zmienność stanowi główne wyzwanie dla modeli predykcyjnych, co motywuje do poszukiwania skutecznych metod filtrujących.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{/home/emdablju/Documents/projects/kalman_stock_prediction/documents/plots/1_AMZN_stock.png}
    \caption{Wykres cenowy względem składnika \textit{Close} Amazon.com Inc (AMZN) w latach 2022-2025}
    \label{fig:amzn_stock_prices}
\end{figure}

Tradycyjnie analiza danych rynkowych opierała się o wskaźniki techniczne. 
Można je określić mianem narzędzi statystycznych reprezentujących różne aspekty zachowań cen.
W niniejszej pracy wykorzystano trzy wskaźniki techniczne, które opiszę w następnych podsekcjach.

\subsubsection{Wskaźnik siły względnej (Relative Strength Index, RSI)}
Wskaźnik siły względnej (RSI) to popularny wskaźnik techniczny używany do oceny siły i prędkości zmian cen aktywów finansowych.
Wyraża się go wzorem:
\begin{equation}
    RSI = 100 - \frac{100}{1 + RS}
\end{equation}
gdzie \( RS \) (Relative Strength) to stosunek średnich wzrostów do średnich spadków cen w określonym czasie. Według badań, optymalny okres do obliczania RSI wynosi 14 dni.

Produktem końcowym RSI jest liczba z zakresu od 0 do 100, która interpretowana jest następująco:
\begin{itemize}
    \item Wartości powyżej 70 sugerują, że akcja jest wykupiona i może nastąpić spadek cen.
    \item Wartości poniżej 30 sugerują, że akcja jest wyprzedana i może nastąpić wzrost cen.
    \item Wartości pomiędzy 30 a 70 wskazują na neutralny stan rynku.
\end{itemize}

\subsubsection{Wstęgi Bollingera (Bollinger Bands)}
Wstęgi Bollingera to narzędzie analizy technicznej, dostarczające informacji o zmienności rynku. 
Składaja się z trzech linii na wykresie cenowym:
\begin{itemize}
    \item \textbf{Środkowa linia:} Prosta średnia krocząca (SMA) obliczona na podstawie cen zamknięcia w określonym czasie. Najczęsciej używanym okresem jest 20 dni.
    \item \textbf{Górna wstęga:} Obliczana jako suma środkowa linia i dwukrotności odchylenia standardowego cen w tym okresie.
    \item \textbf{Dolna wstęga:} Obliczana jako różnica środkowa linia i dwukrotności odchylenia standardowego cen w tym okresie.
\end{itemize}
Na podstawie ww. składowych można zinterpretować dwie nowe miary, które zostały wykorzystane w niniejszej pracy:
\begin{itemize}
    \item \textbf{Bollinger Bandwidth (BBW):} Miara szerokości wstęg Bollingera, obliczana jako stosunek różnicy między górną a dolną wstęgą do środkowej linii:
    \begin{equation}
        BBW = \frac{Upper Band - Lower Band}{Middle Line}
    \end{equation}
    \item \textbf{Bollinger \%B (BB\%):} Miara położenia ceny względem wstęg Bollingera, obliczana jako stosunek różnicy między ceną zamknięcia a dolną wstęgą do różnicy między górną a dolną wstęgą:
    \begin{equation}
        BB\% = \frac{Close - Lower Band}{Upper Band - Lower Band}
    \end{equation}
\end{itemize}

Opisane powyżej wskaźniki techniczne - RSI, BBW oraz BB\% - dostarczają cennych informacji o dynamice rynku. 
W tradycyjnej analizie mogą posłużyć do subiektywnej interpretacji przez analityków.
W nowoczesnych podejściach, opartych na modelach uczenia maszynowego, 
można je wykorzystać do wzbogacenia danych o dodatkowe cechy, co potencjalnie może poprawić jakość prognoz.

% Dzisiaj, wraz z rozwojem mocy obliczeniowej i technik uczenia maszynowego, pojawiły się bardziej zaawansowane metody analizy i prognozowania w dziedzinie finansów.
% Do najpopularniejszych podejść należą sieci rekurencyjne (RNN), w tym ich zaawansowane warianty, takie jak \textit{LSTM} (Long Short-Term Memory) czy \textit{GRU} (Gated Recurrent Units).
% Sieci te są zdolne do uchwycenia złożonych wzorców i zależności w szeregach czasowych, jednak wymagają odpowiedniego przygotowania danych.
% Oznacza to odpowiednie przygotowanie danych w taki sposób, aby model mógł je efektywnie przetworzyć i wyciągnąć z nich istotne informacje.

% %~ Research approach
% \section{Metodyka badań}

% %~ Results
% \section{Wyniki i dyskusja}

% %~ Summary
% \section{Podsumowanie i wnioski}

% %~ Bibliography
% \section{Bibliografia}

% %~ List of figures and tables
% \section{Spis rysunków i tabel}

% %~ Attachments
% \section{Załączniki}


\end{document}
